<html>

<head>
  <title>Pokemon Go Map</title>

  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="js/test.js"></script>
  <script src="js/gyms.js"></script>
  <style>
    html,
    body,
    #mapid {
      padding: 0;
      margin: 0;
      height: 100%;
    }
  </style>
  <script>
    // var json;
    var string = '';

    // zoeken naar:
    // types: ["street_address"]
    // types: ["political", "sublocality", "sublocality_level_2"]
    $(document).ready(function() {
      $.getJSON('js/gyms-loc.json', function(data) {
        $.each(data, function(key, val) {
          var getApi = 'https://maps.googleapis.com/maps/api/geocode/json?latlng=' + val.latitude + ',' + val.longitude + '&key=AIzaSyD4mKkoLlvyIlx2LqC10512BD0_il3Gwqw';

          var region_1, region_2, region_3, street, number, postal;

          $.getJSON(getApi, function(data) {
            // console.log('===============================================');
            for (var i = 0; i < data.results.length; i++) {
              // console.log(data.results[i]);
              if (data.results[i].types.indexOf('street_address') != -1) {
                for (var j = 0; j < data.results[i].address_components.length; j++) {
                  if (data.results[i].address_components[j].types.indexOf('street_number') != -1) {
                    number = data.results[i].address_components[j].long_name;
                    // val.number = data.results[i].address_components[j].long_name;
                  }
                  if (data.results[i].address_components[j].types.indexOf('route') != -1) {
                    street = data.results[i].address_components[j].long_name;
                    // val.street = data.results[i].address_components[j].long_name;
                  }
                  if (data.results[i].address_components[j].types.indexOf('postal_code') != -1) {
                    postal = data.results[i].address_components[j].long_name;
                    // val.postal = data.results[i].address_components[j].long_name;
                  }
                }
              }
              if (data.results[i].types.indexOf('sublocality_level_2') != -1) {
                region_1 = data.results[i].address_components[2].long_name;
                // val.region_1 = data.results[i].address_components[2].long_name;
                region_2 = data.results[i].address_components[1].long_name;
                // val.region_2 = data.results[i].address_components[1].long_name;
                region_3 = data.results[i].address_components[0].long_name;
                // val.region_3 = data.results[i].address_components[0].long_name;
              }
            }

            string = key +
              '\tname:' + val.name +
              '\tlatitude:' + val.latitude +
              '\tlongitude:' + val.longitude +
              '\tregion_1:' + region_1 +
              '\tregion_2:' + region_2 +
              '\tregion_3:' + region_3 +
              '\tstreet:' + street +
              '\tnumber:' + number +
              '\tpostal:' + postal + '\n';

            console.log(string);
          });
        });
      });

      // $('body').html(string);
    });
  </script>
</head>

<body>
</body>

</html>